# Augment Guidelines for Digigoods API

## Code Styles

- Use Lombok to reduce boilerplate codes, especially when defining DTO classes.
- Refer to [`.editorconfig`](./.editorconfig) for general code styles such as indentation, line length, end-of-line symbols.
- Run `mvn checkstyle:check` to check for violations of Java code style. If violations found, read the report and try to fix them.
- Use constructor injection for dependency injection instead of field injection.
- All classes should have proper Javadoc comments explaining their purpose.
- Methods should have Javadoc comments with `@param` and `@return` annotations where applicable.
- Use meaningful variable names and avoid abbreviations.

## API Design Patterns

- Controllers should be thin and delegate business logic to services.
- Use `@RestController` and `@RequestMapping` annotations for REST endpoints.
- Return `ResponseEntity<T>` from controller methods for proper HTTP status control.
- Use proper HTTP methods: GET for retrieval, POST for creation, PUT for updates, DELETE for removal.
- Group related endpoints under the same base path using `@RequestMapping` at class level.
- Use descriptive endpoint paths that follow RESTful conventions.

## Service Layer Guidelines

- Services should contain business logic and coordinate between repositories and other services.
- Use `@Service` annotation for service classes.
- Implement proper error handling with custom exceptions.
- Services should be stateless and thread-safe.
- Use meaningful method names that describe the business operation.
- Validate input parameters and throw appropriate exceptions for invalid data.

## DTO and Model Guidelines

- Use Lombok annotations (`@Data`, `@NoArgsConstructor`, `@AllArgsConstructor`) for DTOs.
- DTOs should have validation annotations (`@NotBlank`, `@NotNull`, etc.) where appropriate.
- Include proper Javadoc comments for DTO classes explaining their purpose.
- Use meaningful field names that match the business domain.
- Provide multiple constructors when needed for different use cases.

## Exception Handling

- Create custom exception classes for specific business errors.
- Use meaningful exception names that describe the error condition.
- Include relevant context information in exception messages.
- Use `@ControllerAdvice` for global exception handling.
- Return appropriate HTTP status codes for different error types.

## Testing

- New code should have corresponding unit tests.
- Integration test of the API should be implemented using Spring's `MockMvc` that can run locally.
- Functional test of the API should be implemented using Postman collection that executed using `newman`.
- Make sure the tests still pass before and after making modification to the codebase.
- Use JUnit 5 test framework. To run the unit test suite, run `mvn test`. Make sure to run unit test suite before committing any code.
- Follow the convention of Arrange-Act-Assert (AAA) for writing tests, including providing short one-liner comments that denote the sections.
- Since we are using JUnit 5 as the test framework, please note the following when generating tests:
  - Name the test methods more verbosely. Write the test method name using Given-When-Then format.
  - Add `@DisplayName` annotation to all test methods and use descriptive names as the values of the annotation.

## Unit Testing Guidelines

- Use `@ExtendWith(MockitoExtension.class)` for unit tests that require mocking.
- Mock external dependencies using `@Mock` annotation.
- Use `@InjectMocks` for the class under test.
- Set up test data in `@BeforeEach` methods.
- Test both success and failure scenarios.
- Include edge cases and boundary conditions.
- Use meaningful assertions that verify the expected behavior.
- Test exception scenarios with `assertThrows()`.

## Integration Testing Guidelines

- Use `@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)` for integration tests.
- Include `@AutoConfigureWebMvc` and `@ActiveProfiles("test")` annotations.
- Use `@Transactional` to ensure test isolation.
- Set up MockMvc in `@BeforeEach` using `MockMvcBuilders.webAppContextSetup()`.
- Clear and set up test data in `@BeforeEach` methods.
- Use `MockMvc.perform()` to simulate HTTP requests.
- Verify HTTP status codes, content types, and JSON responses.
- Use JsonPath expressions to validate response structure and values.

## Code Coverage

- When asked to increase coverage for a specific source code file, check the coverage report of the said source code file first.
- The coverage report of a source code file can be found in `target/site/jacoco/[package name]/[class name].html`.
- When reading the coverage report, identify which lines and branches that are yet to be covered.
- Make sure to run `mvn test` before and after adding tests.
- Aim for high code coverage but prioritize meaningful tests over coverage percentage.
- Focus on testing critical business logic and error handling paths.

## Security Guidelines

- Use proper authentication and authorization mechanisms.
- Validate all input parameters to prevent injection attacks.
- Use JWT tokens for stateless authentication.
- Implement proper error handling that doesn't expose sensitive information.
- Follow the principle of least privilege for access control.

## Performance Guidelines

- Use appropriate data structures and algorithms for the use case.
- Implement proper database indexing for frequently queried fields.
- Use pagination for large result sets.
- Avoid N+1 query problems by using appropriate fetch strategies.
- Consider caching for frequently accessed data.

## Documentation Guidelines

- All public APIs should have comprehensive Javadoc documentation.
- Include examples in documentation where helpful.
- Document any assumptions or constraints.
- Keep documentation up-to-date with code changes.
- Use clear and concise language in documentation.

## Git and Version Control

- Write clear and descriptive commit messages.
- Use feature branches for new development.
- Ensure all tests pass before committing code.
- Include relevant test updates with code changes.
- Follow semantic versioning for releases.
